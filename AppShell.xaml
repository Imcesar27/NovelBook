<?xml version="1.0" encoding="UTF-8" ?>
<Shell
    x:Class="NovelBook.AppShell"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:local="clr-namespace:NovelBook"
    xmlns:views="clr-namespace:NovelBook.Views"
    Shell.FlyoutBackgroundColor="{StaticResource BackgroundDark}"
    Shell.FlyoutHeaderBehavior="CollapseOnScroll">

    <!-- Estilo del Shell -->
    <Shell.Resources>
        <ResourceDictionary>
            <Style x:Key="BaseStyle" TargetType="Element">
                <Setter Property="Shell.BackgroundColor" Value="{StaticResource BackgroundDark}" />
                <Setter Property="Shell.ForegroundColor" Value="{StaticResource TextPrimary}" />
                <Setter Property="Shell.TitleColor" Value="{StaticResource TextPrimary}" />
                <Setter Property="Shell.DisabledColor" Value="{StaticResource TextMuted}" />
                <Setter Property="Shell.UnselectedColor" Value="{StaticResource TextSecondary}" />
                <Setter Property="Shell.TabBarBackgroundColor" Value="{StaticResource BackgroundDark}" />
                <Setter Property="Shell.TabBarForegroundColor" Value="{StaticResource TextPrimary}"/>
                <Setter Property="Shell.TabBarUnselectedColor" Value="{StaticResource TextSecondary}"/>
                <Setter Property="Shell.TabBarTitleColor" Value="{StaticResource TextPrimary}"/>
            </Style>
            <Style TargetType="TabBar" BasedOn="{StaticResource BaseStyle}" />
            <Style TargetType="FlyoutItem" BasedOn="{StaticResource BaseStyle}" />
            <Style TargetType="Shell" ApplyToDerivedTypes="True">
                <Setter Property="Shell.ForegroundColor" Value="{StaticResource TextPrimary}" />
                <Setter Property="Shell.BackgroundColor" Value="{StaticResource BackgroundDark}" />
                <Setter Property="Shell.TitleColor" Value="{StaticResource TextPrimary}" />
                <Setter Property="Shell.NavBarHasShadow" Value="True"/>
            </Style>
        </ResourceDictionary>
    </Shell.Resources>

    <!-- Header del menÃº lateral -->
    <Shell.FlyoutHeader>
        <Grid BackgroundColor="{StaticResource BackgroundMedium}" 
              HeightRequest="200"
              Padding="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <Label Text="ðŸ“š" 
                   FontSize="60"
                   HorizontalOptions="Center"
                   VerticalOptions="Center"
                   Grid.Row="0"/>

            <Label Text="NOVELBOOK" 
                   FontSize="24"
                   FontAttributes="Bold"
                   TextColor="{StaticResource Primary}"
                   HorizontalOptions="Center"
                   Grid.Row="1"/>

            <Label Text="Tu biblioteca personal"
                   FontSize="14"
                   TextColor="{StaticResource TextSecondary}"
                   HorizontalOptions="Center"
                   Grid.Row="2"
                   Margin="0,0,0,10"/>
        </Grid>
    </Shell.FlyoutHeader>

    <!-- Items principales con TabBar -->
    <TabBar>
        <Tab Title="ðŸ“š LibrerÃ­a" Icon="library_icon.png" Route="LibraryTab">
            <ShellContent Title="Mi LibrerÃ­a" Route="LibraryPage" ContentTemplate="{DataTemplate views:LibraryPage}"/>
        </Tab>

        <Tab Title="ðŸŒ Explorar" Icon="explore_icon.png" Route="ExploreTab">
            <ShellContent Title="Explorar Novelas" Route="ExplorePage" ContentTemplate="{DataTemplate views:ExplorePage}"/>
        </Tab>

        <Tab Title="ðŸ“ Historial" Icon="history_icon.png" Route="HistoryTab">
            <ShellContent Title="Historial de Lectura" Route="HistoryPage" ContentTemplate="{DataTemplate views:HistoryPage}"/>
        </Tab>

        <Tab Title="âž• MÃ¡s" Icon="more_icon.png" Route="MoreTab">
            <ShellContent Title="MÃ¡s Opciones" Route="MorePage" ContentTemplate="{DataTemplate views:MorePage}"/>
        </Tab>
    </TabBar>

    <!-- Items del menÃº lateral (Flyout) -->
    <FlyoutItem Title="âš™ï¸ ConfiguraciÃ³n" Icon="settings_icon.png" Route="SettingsTab">
        <ShellContent Title="ConfiguraciÃ³n" Route="SettingsPage" ContentTemplate="{DataTemplate views:SettingsPage}"/>
    </FlyoutItem>

    <FlyoutItem Title="ðŸ“¥ Descargas" Icon="download_icon.png" Route="DownloadsTab">
        <ShellContent Title="Descargas" Route="DownloadsPage" ContentTemplate="{DataTemplate views:DownloadsPage}"/>
    </FlyoutItem>

    <FlyoutItem Title="ðŸ“Š EstadÃ­sticas" Icon="stats_icon.png" Route="StatsTab">
        <ShellContent Title="EstadÃ­sticas" Route="StatsPage" ContentTemplate="{DataTemplate views:StatsPage}"/>
    </FlyoutItem>

    <!-- PÃ¡ginas no en Tabs ni Flyout (solo navegaciÃ³n por rutas) -->
    <!-- No van aquÃ­, se registran en AppShell.xaml.cs -->

    <!-- Footer menÃº -->
    <Shell.FlyoutFooter>
        <VerticalStackLayout Padding="10,10" BackgroundColor="{StaticResource BackgroundMedium}">
            <Button Text="ðŸ” Cerrar SesiÃ³n"
                    BackgroundColor="{StaticResource Primary}"
                    TextColor="{StaticResource TextPrimary}"
                    Margin="10"
                    Clicked="OnLogoutClicked"/>
        </VerticalStackLayout>
    </Shell.FlyoutFooter>

</Shell>
