<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:extensions="clr-namespace:NovelBook.Extensions"
             x:Class="NovelBook.Views.MorePage"
             Title="{extensions:Translate More}"
             BackgroundColor="{StaticResource BackgroundDark}">

    <ScrollView>
        <VerticalStackLayout Spacing="0" Padding="0">

            <!-- Header con informaciÃ³n del usuario -->
            <Frame BackgroundColor="{StaticResource BackgroundMedium}"
                   CornerRadius="0"
                   Padding="20"
                   Margin="0,0,0,20">
                <Grid x:Name="UserInfoGrid">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Avatar actualizado para soportar imagen -->
                    <Frame Grid.Column="0"
                           CornerRadius="40"
                           Padding="0"
                           BackgroundColor="{StaticResource Primary}"
                           HeightRequest="80"
                           WidthRequest="80"
                           HorizontalOptions="Start">
                        <Frame.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnAvatarTapped"/>
                        </Frame.GestureRecognizers>
                        <Grid>
                            <!-- Imagen de perfil -->
                            <Image x:Name="ProfileImage"
                                   Aspect="AspectFill"
                                   IsVisible="False"/>
                            <!-- Letra inicial cuando no hay imagen -->
                            <Label x:Name="AvatarLabel"
                                   Text="U"
                                   TextColor="White"
                                   FontSize="32"
                                   FontAttributes="Bold"
                                   HorizontalOptions="Center"
                                   VerticalOptions="Center"
                                   IsVisible="True"/>
                            <!-- Ãcono de cÃ¡mara overlay -->
                            <Frame CornerRadius="12"
                                   BackgroundColor="{StaticResource BackgroundDark}"
                                   Padding="0"
                                   WidthRequest="24"
                                   HeightRequest="24"
                                   HorizontalOptions="End"
                                   VerticalOptions="End"
                                   Margin="0,0,5,5"
                                   HasShadow="False">
                                <Label Text="ðŸ“·"
                                       FontSize="14"
                                       HorizontalOptions="Center"
                                       VerticalOptions="Center"/>
                            </Frame>
                        </Grid>
                    </Frame>

                    <!-- InformaciÃ³n del usuario -->
                    <VerticalStackLayout Grid.Column="1"
                                       Padding="15,0,0,0"
                                       VerticalOptions="Center">
                        <Label x:Name="UserNameLabel"
                               Text="{extensions:Translate GuestUser}"
                               FontSize="20"
                               FontAttributes="Bold"
                               TextColor="{StaticResource TextPrimary}"/>
                        <Label x:Name="UserEmailLabel"
                               Text="{extensions:Translate NoEmailRegistered}"
                               FontSize="14"
                               TextColor="{StaticResource TextSecondary}"/>
                        <Label x:Name="MemberSinceLabel"
                               Text="Miembro desde: Enero 2024"
                               FontSize="12"
                               TextColor="{StaticResource TextMuted}"
                               Margin="0,5,0,0"/>
                    </VerticalStackLayout>
                </Grid>
            </Frame>

            <!-- Opciones principales -->
            <VerticalStackLayout Spacing="0" Padding="0">

                <!-- Modo de lectura -->
                <Grid BackgroundColor="{StaticResource BackgroundDark}"
                      Padding="20,15">
                    <Grid.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnOptionTapped" CommandParameter="ReadingMode"/>
                    </Grid.GestureRecognizers>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <Label Grid.Column="0"
                           Text="ðŸŒ™"
                           FontSize="24"
                           VerticalOptions="Center"
                           Margin="0,0,15,0"/>

                    <VerticalStackLayout Grid.Column="1">
                        <Label Text="{extensions:Translate IncognitoMode}"
                               TextColor="{StaticResource TextPrimary}"
                               FontSize="16"/>
                        <Label Text="{extensions:Translate IncognitoModeDescription}"
                               TextColor="{StaticResource TextSecondary}"
                               FontSize="12"/>
                    </VerticalStackLayout>

                    <Switch Grid.Column="2"
                            x:Name="IncognitoSwitch"
                            OnColor="{StaticResource Primary}"
                            ThumbColor="White"
                            Toggled="OnIncognitoToggled"/>
                </Grid>

                <BoxView HeightRequest="1" BackgroundColor="{StaticResource BackgroundMedium}" Margin="20,0"/>

                <!-- Gestionar Face ID/Touch ID -->
                <Grid BackgroundColor="{StaticResource BackgroundDark}"
                      Padding="20,15">
                    <Grid.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnOptionTapped" CommandParameter="BiometricSettings"/>
                    </Grid.GestureRecognizers>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <Label Grid.Column="0"
                           Text="ðŸ”"
                           FontSize="24"
                           VerticalOptions="Center"
                           Margin="0,0,15,0"/>

                    <VerticalStackLayout Grid.Column="1" 
                                       VerticalOptions="Center">
                        <Label Text="Face ID / Touch ID"
                               TextColor="{StaticResource TextPrimary}"
                               FontSize="16"/>
                        <Label x:Name="BiometricStatusMoreLabel"
                               Text="No configurado"
                               TextColor="{StaticResource TextSecondary}"
                               FontSize="12"/>
                    </VerticalStackLayout>

                    <Label Grid.Column="2"
                           Text="â†’"
                           TextColor="{StaticResource TextSecondary}"
                           FontSize="20"
                           VerticalOptions="Center"/>
                </Grid>

                <!-- SecciÃ³n Admin (solo visible para administradores) -->
                <BoxView x:Name="AdminSeparator" 
                         HeightRequest="10" 
                         BackgroundColor="{StaticResource BackgroundMedium}" 
                         Margin="0,20,0,20"
                         IsVisible="False"/>

                <VerticalStackLayout x:Name="AdminSection" IsVisible="False">
                    <Label Text="{extensions:Translate Administration}"
                           FontSize="16"
                           FontAttributes="Bold"
                           TextColor="{StaticResource Primary}"
                           Margin="20,0,0,10"/>

                    <!-- Crear Novela -->
                    <Grid BackgroundColor="{StaticResource BackgroundDark}"
                          Padding="20,15">
                        <Grid.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnOptionTapped" CommandParameter="CreateNovel"/>
                        </Grid.GestureRecognizers>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <Label Grid.Column="0"
                               Text="ðŸ“"
                               FontSize="24"
                               VerticalOptions="Center"
                               Margin="0,0,15,0"/>

                        <VerticalStackLayout Grid.Column="1">
                            <Label Text="{extensions:Translate CreateNovel}"
                                   TextColor="{StaticResource TextPrimary}"
                                   FontSize="16"/>
                            <Label Text="Agregar nueva novela a la biblioteca"
                                   TextColor="{StaticResource TextSecondary}"
                                   FontSize="12"/>
                        </VerticalStackLayout>

                        <Label Grid.Column="2"
                               Text="â†’"
                               TextColor="{StaticResource TextSecondary}"
                               FontSize="20"
                               VerticalOptions="Center"/>
                    </Grid>

                    <BoxView HeightRequest="1" BackgroundColor="{StaticResource BackgroundMedium}" Margin="20,0"/>

                    <!-- Gestionar Novelas -->
                    <Grid BackgroundColor="{StaticResource BackgroundDark}"
                          Padding="20,15">
                        <Grid.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnOptionTapped" CommandParameter="ManageNovels"/>
                        </Grid.GestureRecognizers>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <Label Grid.Column="0"
                               Text="ðŸ“š"
                               FontSize="24"
                               VerticalOptions="Center"
                               Margin="0,0,15,0"/>

                        <VerticalStackLayout Grid.Column="1">
                            <Label Text="{extensions:Translate ManageNovels}"
                                   TextColor="{StaticResource TextPrimary}"
                                   FontSize="16"/>
                            <Label Text="Editar o eliminar novelas existentes"
                                   TextColor="{StaticResource TextSecondary}"
                                   FontSize="12"/>
                        </VerticalStackLayout>

                        <Label Grid.Column="2"
                               Text="â†’"
                               TextColor="{StaticResource TextSecondary}"
                               FontSize="20"
                               VerticalOptions="Center"/>
                    </Grid>
                </VerticalStackLayout>

                <BoxView HeightRequest="10" BackgroundColor="{StaticResource BackgroundMedium}" Margin="0,20,0,0"/>

                <!-- Descargas -->
                <Grid BackgroundColor="{StaticResource BackgroundDark}"
                      Padding="20,15">
                    <Grid.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnOptionTapped" CommandParameter="Downloads"/>
                    </Grid.GestureRecognizers>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <Label Grid.Column="0"
                           Text="ðŸ“¥"
                           FontSize="24"
                           VerticalOptions="Center"
                           Margin="0,0,15,0"/>

                    <VerticalStackLayout Grid.Column="1">
                        <Label Text="{extensions:Translate Downloads}"
                               TextColor="{StaticResource TextPrimary}"
                               FontSize="16"/>
                        <Label Text="{extensions:Translate ManageNovel}"
                               TextColor="{StaticResource TextSecondary}"
                               FontSize="12"/>
                    </VerticalStackLayout>

                    <Label Grid.Column="2"
                           Text="â†’"
                           TextColor="{StaticResource TextSecondary}"
                           FontSize="20"
                           VerticalOptions="Center"/>
                </Grid>

                <BoxView HeightRequest="1" BackgroundColor="{StaticResource BackgroundMedium}" Margin="20,0"/>

                <!-- Cola de descargas -->
                <Grid BackgroundColor="{StaticResource BackgroundDark}"
                      Padding="20,15">
                    <Grid.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnOptionTapped" CommandParameter="DownloadQueue"/>
                    </Grid.GestureRecognizers>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <Label Grid.Column="0"
                           Text="ðŸ“‹"
                           FontSize="24"
                           VerticalOptions="Center"
                           Margin="0,0,15,0"/>

                    <VerticalStackLayout Grid.Column="1">
                        <Label Text="{extensions:Translate DownloadQueue}"
                               TextColor="{StaticResource TextPrimary}"
                               FontSize="16"/>
                        <Label Text="{extensions:Translate NoPendingDownloads}"
                               TextColor="{StaticResource TextSecondary}"
                               FontSize="12"/>
                    </VerticalStackLayout>

                    <Label Grid.Column="2"
                           Text="â†’"
                           TextColor="{StaticResource TextSecondary}"
                           FontSize="20"
                           VerticalOptions="Center"/>
                </Grid>

                <BoxView HeightRequest="1" BackgroundColor="{StaticResource BackgroundMedium}" Margin="20,0"/>

                <!-- CategorÃ­as -->
                <Grid BackgroundColor="{StaticResource BackgroundDark}"
                      Padding="20,15">
                    <Grid.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnOptionTapped" CommandParameter="Categories"/>
                    </Grid.GestureRecognizers>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <Label Grid.Column="0"
                           Text="ðŸ“š"
                           FontSize="24"
                           VerticalOptions="Center"
                           Margin="0,0,15,0"/>

                    <Label Grid.Column="1"
                           Text="{extensions:Translate Categories}"
                           TextColor="{StaticResource TextPrimary}"
                           FontSize="16"
                           VerticalOptions="Center"/>

                    <Label Grid.Column="2"
                           Text="â†’"
                           TextColor="{StaticResource TextSecondary}"
                           FontSize="20"
                           VerticalOptions="Center"/>
                </Grid>

                <BoxView HeightRequest="1" BackgroundColor="{StaticResource BackgroundMedium}" Margin="20,0"/>

                <!-- EstadÃ­sticas -->
                <Grid BackgroundColor="{StaticResource BackgroundDark}"
                      Padding="20,15">
                    <Grid.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnOptionTapped" CommandParameter="Statistics"/>
                    </Grid.GestureRecognizers>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <Label Grid.Column="0"
                           Text="ðŸ“Š"
                           FontSize="24"
                           VerticalOptions="Center"
                           Margin="0,0,15,0"/>

                    <Label Grid.Column="1"
                           Text="{extensions:Translate Statistics}"
                           TextColor="{StaticResource TextPrimary}"
                           FontSize="16"
                           VerticalOptions="Center"/>

                    <Label Grid.Column="2"
                           Text="â†’"
                           TextColor="{StaticResource TextSecondary}"
                           FontSize="20"
                           VerticalOptions="Center"/>
                </Grid>

                <BoxView HeightRequest="10" BackgroundColor="{StaticResource BackgroundMedium}" Margin="0,20,0,0"/>

                <!-- ConfiguraciÃ³n -->
                <Grid BackgroundColor="{StaticResource BackgroundDark}"
                      Padding="20,15">
                    <Grid.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnOptionTapped" CommandParameter="Settings"/>
                    </Grid.GestureRecognizers>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <Label Grid.Column="0"
                           Text="âš™ï¸"
                           FontSize="24"
                           VerticalOptions="Center"
                           Margin="0,0,15,0"/>

                    <Label Grid.Column="1"
                           Text="{extensions:Translate Settings}"
                           TextColor="{StaticResource TextPrimary}"
                           FontSize="16"
                           VerticalOptions="Center"/>

                    <Label Grid.Column="2"
                           Text="â†’"
                           TextColor="{StaticResource TextSecondary}"
                           FontSize="20"
                           VerticalOptions="Center"/>
                </Grid>

                <BoxView HeightRequest="1" BackgroundColor="{StaticResource BackgroundMedium}" Margin="20,0"/>

                <!-- Acerca de -->
                <Grid BackgroundColor="{StaticResource BackgroundDark}"
                      Padding="20,15">
                    <Grid.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnOptionTapped" CommandParameter="About"/>
                    </Grid.GestureRecognizers>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <Label Grid.Column="0"
                           Text="â„¹ï¸"
                           FontSize="24"
                           VerticalOptions="Center"
                           Margin="0,0,15,0"/>

                    <Label Grid.Column="1"
                           Text="{extensions:Translate About}"
                           TextColor="{StaticResource TextPrimary}"
                           FontSize="16"
                           VerticalOptions="Center"/>

                    <Label Grid.Column="2"
                           Text="â†’"
                           TextColor="{StaticResource TextSecondary}"
                           FontSize="20"
                           VerticalOptions="Center"/>
                </Grid>

                <!-- Separador antes de logout -->
                <BoxView HeightRequest="10" BackgroundColor="{StaticResource BackgroundMedium}" Margin="0,20,0,0"/>

                <!-- Cerrar SesiÃ³n -->
                <Grid BackgroundColor="{StaticResource BackgroundDark}"
                      Padding="20,15">
                    <Grid.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnOptionTapped" CommandParameter="Logout"/>
                    </Grid.GestureRecognizers>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <Label Grid.Column="0"
                           Text="ðŸšª"
                           FontSize="24"
                           VerticalOptions="Center"
                           Margin="0,0,15,0"/>

                    <Label Grid.Column="1"
                           Text="{extensions:Translate Logout}"
                           TextColor="{StaticResource Error}"
                           FontSize="16"
                           VerticalOptions="Center"/>

                    <Label Grid.Column="2"
                           Text="â†’"
                           TextColor="{StaticResource TextSecondary}"
                           FontSize="20"
                           VerticalOptions="Center"/>
                </Grid>

            </VerticalStackLayout>

            <!-- VersiÃ³n de la app -->
            <Label Text="NovelBook v1.0.0"
                   TextColor="{StaticResource TextMuted}"
                   FontSize="12"
                   HorizontalOptions="Center"
                   Margin="0,30,0,20"/>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>