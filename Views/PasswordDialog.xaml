<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="NovelBook.Views.Dialogs.PasswordDialog"
             Title="PasswordDialog"
             BackgroundColor="Transparent">

    <!-- Fondo semi-transparente -->
    <Grid BackgroundColor="#80000000">

        <!-- Contenedor del diÃ¡logo -->
        <Frame BackgroundColor="{StaticResource BackgroundDark}"
               CornerRadius="20"
               Padding="0"
               Margin="40"
               VerticalOptions="Center"
               HorizontalOptions="Center"
               WidthRequest="350">

            <VerticalStackLayout Spacing="0">

                <!-- Header -->
                <VerticalStackLayout BackgroundColor="{StaticResource BackgroundMedium}"
                                   Padding="20,20,20,15"
                                   Spacing="5">
                    <Label Text="VerificaciÃ³n"
                           FontSize="20"
                           FontAttributes="Bold"
                           TextColor="{StaticResource TextPrimary}"/>
                    <Label Text="Ingresa tu contraseÃ±a actual para habilitar Face ID/Touch ID"
                           FontSize="14"
                           TextColor="{StaticResource TextSecondary}"
                           LineBreakMode="WordWrap"/>
                </VerticalStackLayout>

                <!-- Contenido -->
                <VerticalStackLayout Padding="20" Spacing="15">

                    <!-- Campo de contraseÃ±a con botÃ³n de mostrar/ocultar -->
                    <Frame BackgroundColor="{StaticResource BackgroundMedium}"
                           CornerRadius="10"
                           Padding="0"
                           HeightRequest="50">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="50"/>
                            </Grid.ColumnDefinitions>

                            <!-- Entry de contraseÃ±a -->
                            <Entry x:Name="PasswordEntry"
                                   Grid.Column="0"
                                   Placeholder="ContraseÃ±a"
                                   PlaceholderColor="{StaticResource TextMuted}"
                                   TextColor="{StaticResource TextPrimary}"
                                   IsPassword="True"
                                   BackgroundColor="Transparent"
                                   VerticalOptions="Center"
                                   Margin="15,0,0,0"
                                   ReturnType="Done"
                                   Completed="OnPasswordCompleted"/>

                            <!-- BotÃ³n de mostrar/ocultar -->
                            <Frame Grid.Column="1"
                                   BackgroundColor="Transparent"
                                   Padding="0"
                                   CornerRadius="0"
                                   HasShadow="False">
                                <Frame.GestureRecognizers>
                                    <TapGestureRecognizer Tapped="OnTogglePasswordVisibility"/>
                                </Frame.GestureRecognizers>
                                <Label x:Name="VisibilityIcon"
                                       Text="ðŸ‘ï¸"
                                       FontSize="20"
                                       HorizontalOptions="Center"
                                       VerticalOptions="Center"/>
                            </Frame>
                        </Grid>
                    </Frame>

                    <!-- Mensaje de error (oculto por defecto) -->
                    <Label x:Name="ErrorLabel"
                           Text="ContraseÃ±a incorrecta"
                           TextColor="{StaticResource Error}"
                           FontSize="12"
                           HorizontalOptions="Center"
                           IsVisible="False"/>
                </VerticalStackLayout>

                <!-- Botones -->
                <Grid BackgroundColor="{StaticResource BackgroundMedium}"
                      Padding="20"
                      ColumnSpacing="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- BotÃ³n Cancelar -->
                    <Button Grid.Column="0"
                            Text="Cancelar"
                            BackgroundColor="{StaticResource BackgroundDark}"
                            TextColor="{StaticResource TextPrimary}"
                            CornerRadius="10"
                            HeightRequest="45"
                            Clicked="OnCancelClicked"/>

                    <!-- BotÃ³n Confirmar -->
                    <Button Grid.Column="1"
                            x:Name="ConfirmButton"
                            Text="Confirmar"
                            BackgroundColor="{StaticResource Primary}"
                            TextColor="White"
                            CornerRadius="10"
                            HeightRequest="45"
                            FontAttributes="Bold"
                            Clicked="OnConfirmClicked"/>
                </Grid>
            </VerticalStackLayout>
        </Frame>
    </Grid>
</ContentPage>