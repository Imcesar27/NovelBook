<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="NovelBook.Views.StatsPage"
             Title="EstadÃ­sticas"
             BackgroundColor="{StaticResource PageBackgroundColor}">

    <ScrollView>
        <StackLayout Padding="15" Spacing="15">
            <!-- Header con resumen principal -->
            <Frame BackgroundColor="{StaticResource CardBackgroundColor}"
                   CornerRadius="15"
                   Padding="20"
                   HasShadow="False">
                <Grid RowDefinitions="Auto,Auto,Auto" RowSpacing="15">
                    <!-- TÃ­tulo y periodo -->
                    <StackLayout Grid.Row="0">
                        <Label Text="Tu Resumen de Lectura"
                               FontSize="24"
                               FontAttributes="Bold"
                               TextColor="White" />
                        <Label x:Name="MemberSinceLabel"
                               Text="Miembro desde: -"
                               FontSize="14"
                               TextColor="#B0B0B0" />
                    </StackLayout>

                    <!-- EstadÃ­sticas principales en grid -->
                    <Grid Grid.Row="1" ColumnDefinitions="*,*,*,*" RowDefinitions="Auto,Auto">
                        <!-- CapÃ­tulos -->
                        <StackLayout Grid.Column="0">
                            <Label x:Name="TotalChaptersLabel"
                                   Text="0"
                                   FontSize="32"
                                   FontAttributes="Bold"
                                   TextColor="{StaticResource PrimaryColor}"
                                   HorizontalTextAlignment="Center" />
                            <Label Text="CapÃ­tulos"
                                   FontSize="12"
                                   TextColor="#B0B0B0"
                                   HorizontalTextAlignment="Center" />
                        </StackLayout>

                        <!-- Novelas -->
                        <StackLayout Grid.Column="1">
                            <Label x:Name="TotalNovelsLabel"
                                   Text="0"
                                   FontSize="32"
                                   FontAttributes="Bold"
                                   TextColor="#4CAF50"
                                   HorizontalTextAlignment="Center" />
                            <Label Text="Novelas"
                                   FontSize="12"
                                   TextColor="#B0B0B0"
                                   HorizontalTextAlignment="Center" />
                        </StackLayout>

                        <!-- Tiempo -->
                        <StackLayout Grid.Column="2">
                            <Label x:Name="TotalTimeLabel"
                                   Text="0h"
                                   FontSize="32"
                                   FontAttributes="Bold"
                                   TextColor="#FF9800"
                                   HorizontalTextAlignment="Center" />
                            <Label Text="Tiempo"
                                   FontSize="12"
                                   TextColor="#B0B0B0"
                                   HorizontalTextAlignment="Center" />
                        </StackLayout>

                        <!-- Racha -->
                        <StackLayout Grid.Column="3">
                            <Label x:Name="CurrentStreakLabel"
                                   Text="0"
                                   FontSize="32"
                                   FontAttributes="Bold"
                                   TextColor="#E91E63"
                                   HorizontalTextAlignment="Center" />
                            <Label Text="Racha"
                                   FontSize="12"
                                   TextColor="#B0B0B0"
                                   HorizontalTextAlignment="Center" />
                        </StackLayout>
                    </Grid>

                    <!-- Promedios -->
                    <Grid Grid.Row="2" ColumnDefinitions="*,*">
                        <Label Grid.Column="0"
                               x:Name="AvgChaptersLabel"
                               Text="ðŸ“– 0 cap/dÃ­a"
                               FontSize="14"
                               TextColor="White"
                               HorizontalTextAlignment="Center" />
                        <Label Grid.Column="1"
                               x:Name="AvgTimeLabel"
                               Text="â±ï¸ 0 min/dÃ­a"
                               FontSize="14"
                               TextColor="White"
                               HorizontalTextAlignment="Center" />
                    </Grid>
                </Grid>
            </Frame>

            <!-- Estado de la biblioteca -->
            <Frame BackgroundColor="{StaticResource CardBackgroundColor}"
                   CornerRadius="15"
                   Padding="20"
                   HasShadow="False">
                <StackLayout Spacing="15">
                    <Label Text="Mi Biblioteca"
                           FontSize="20"
                           FontAttributes="Bold"
                           TextColor="White" />

                    <!-- GrÃ¡fico circular de estados -->
                    <Grid ColumnDefinitions="*,Auto">
                        <!-- Canvas para el grÃ¡fico circular -->
                        <Frame Grid.Column="0"
                               BackgroundColor="Transparent"
                               HeightRequest="150"
                               WidthRequest="150"
                               HorizontalOptions="Start">
                            <Grid x:Name="PieChartContainer">
                                <!-- El grÃ¡fico se dibujarÃ¡ aquÃ­ dinÃ¡micamente -->
                            </Grid>
                        </Frame>

                        <!-- Leyenda -->
                        <StackLayout Grid.Column="1"
                                     Spacing="10"
                                     VerticalOptions="Center"
                                     Margin="20,0,0,0">
                            <HorizontalStackLayout>
                                <BoxView Color="#4CAF50" WidthRequest="15" HeightRequest="15" CornerRadius="2" />
                                <Label x:Name="ReadingCountLabel" Text="Leyendo: 0" Margin="10,0,0,0" TextColor="White" />
                            </HorizontalStackLayout>
                            <HorizontalStackLayout>
                                <BoxView Color="#2196F3" WidthRequest="15" HeightRequest="15" CornerRadius="2" />
                                <Label x:Name="CompletedCountLabel" Text="Completados: 0" Margin="10,0,0,0" TextColor="White" />
                            </HorizontalStackLayout>
                            <HorizontalStackLayout>
                                <BoxView Color="#FF9800" WidthRequest="15" HeightRequest="15" CornerRadius="2" />
                                <Label x:Name="PlanToReadCountLabel" Text="Por leer: 0" Margin="10,0,0,0" TextColor="White" />
                            </HorizontalStackLayout>
                            <HorizontalStackLayout>
                                <BoxView Color="#E91E63" WidthRequest="15" HeightRequest="15" CornerRadius="2" />
                                <Label x:Name="FavoritesCountLabel" Text="Favoritos: 0" Margin="10,0,0,0" TextColor="White" />
                            </HorizontalStackLayout>
                        </StackLayout>
                    </Grid>

                    <!-- Tasa de completaciÃ³n -->
                    <StackLayout>
                        <Label Text="Tasa de completaciÃ³n" FontSize="14" TextColor="#B0B0B0" />
                        <ProgressBar x:Name="CompletionProgressBar" Progress="0" ProgressColor="{StaticResource PrimaryColor}" />
                        <Label x:Name="CompletionRateLabel" Text="0% completado" FontSize="12" TextColor="#B0B0B0" HorizontalTextAlignment="Center" />
                    </StackLayout>
                </StackLayout>
            </Frame>

            <!-- Actividad de los Ãºltimos 7 dÃ­as -->
            <Frame BackgroundColor="{StaticResource CardBackgroundColor}"
                   CornerRadius="15"
                   Padding="20"
                   HasShadow="False">
                <StackLayout Spacing="15">
                    <Label Text="Ãšltimos 7 dÃ­as"
                           FontSize="20"
                           FontAttributes="Bold"
                           TextColor="White" />

                    <!-- GrÃ¡fico de barras -->
                    <Grid x:Name="WeeklyChartContainer"
                          HeightRequest="150"
                          RowDefinitions="*,Auto"
                          ColumnDefinitions="*,*,*,*,*,*,*">
                        <!-- Las barras se agregarÃ¡n dinÃ¡micamente -->
                    </Grid>

                    <Label x:Name="WeeklyTotalLabel"
                           Text="Total esta semana: 0 capÃ­tulos"
                           FontSize="14"
                           TextColor="#B0B0B0"
                           HorizontalTextAlignment="Center" />
                </StackLayout>
            </Frame>

            <!-- GÃ©neros favoritos -->
            <Frame BackgroundColor="{StaticResource CardBackgroundColor}"
                   CornerRadius="15"
                   Padding="20"
                   HasShadow="False">
                <StackLayout Spacing="15">
                    <Label Text="GÃ©neros mÃ¡s leÃ­dos"
                           FontSize="20"
                           FontAttributes="Bold"
                           TextColor="White" />

                    <StackLayout x:Name="GenreStatsContainer" Spacing="10">
                        <!-- Los gÃ©neros se agregarÃ¡n dinÃ¡micamente -->
                    </StackLayout>
                </StackLayout>
            </Frame>

            <!-- Autores favoritos -->
            <Frame BackgroundColor="{StaticResource CardBackgroundColor}"
                   CornerRadius="15"
                   Padding="20"
                   HasShadow="False">
                <StackLayout Spacing="15">
                    <Label Text="Autores favoritos"
                           FontSize="20"
                           FontAttributes="Bold"
                           TextColor="White" />

                    <StackLayout x:Name="AuthorStatsContainer" Spacing="10">
                        <!-- Los autores se agregarÃ¡n dinÃ¡micamente -->
                    </StackLayout>
                </StackLayout>
            </Frame>

            <!-- Logros -->
            <Frame BackgroundColor="{StaticResource CardBackgroundColor}"
                   CornerRadius="15"
                   Padding="20"
                   HasShadow="False">
                <StackLayout Spacing="15">
                    <Grid ColumnDefinitions="*,Auto">
                        <Label Grid.Column="0"
                               Text="Logros desbloqueados"
                               FontSize="20"
                               FontAttributes="Bold"
                               TextColor="White" />
                        <Button Grid.Column="1"
                                Text="Ver todos"
                                BackgroundColor="Transparent"
                                TextColor="{StaticResource PrimaryColor}"
                                FontSize="14"
                                Clicked="OnViewAllAchievements" />
                    </Grid>

                    <ScrollView Orientation="Horizontal" HeightRequest="120">
                        <HorizontalStackLayout x:Name="AchievementsContainer" Spacing="10">
                            <!-- Los logros se agregarÃ¡n dinÃ¡micamente -->
                        </HorizontalStackLayout>
                    </ScrollView>

                    <Label x:Name="AchievementCountLabel"
                           Text="0/10 logros desbloqueados"
                           FontSize="14"
                           TextColor="#B0B0B0" />
                </StackLayout>
            </Frame>

            <!-- Horas de lectura -->
            <Frame BackgroundColor="{StaticResource CardBackgroundColor}"
                   CornerRadius="15"
                   Padding="20"
                   HasShadow="False">
                <StackLayout Spacing="15">
                    <Label Text="Horas mÃ¡s activas"
                           FontSize="20"
                           FontAttributes="Bold"
                           TextColor="White" />

                    <Label Text="Descubre cuÃ¡ndo lees mÃ¡s"
                           FontSize="14"
                           TextColor="#B0B0B0" />

                    <Grid x:Name="HourlyChartContainer"
                          HeightRequest="150">
                        <!-- El grÃ¡fico de horas se agregarÃ¡ dinÃ¡micamente -->
                    </Grid>
                </StackLayout>
            </Frame>

            <!-- Indicador de carga -->
            <ActivityIndicator x:Name="LoadingIndicator"
                               IsRunning="False"
                               IsVisible="False"
                               Color="{StaticResource PrimaryColor}"
                               VerticalOptions="CenterAndExpand"
                               HorizontalOptions="CenterAndExpand" />
        </StackLayout>
    </ScrollView>
</ContentPage>