<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="NovelBook.Views.SettingsPage"
             Title="{extensions:Translate Settings}"
             xmlns:extensions="clr-namespace:NovelBook.Extensions">

    <ScrollView>
        <VerticalStackLayout Spacing="0" Padding="20">

            <!-- Header -->
            <Label Text="{extensions:Translate Settings}"
                   FontSize="28"
                   FontAttributes="Bold"
                   TextColor="{AppThemeBinding Light={StaticResource TextPrimaryLight}, Dark={StaticResource TextPrimary}}"
                   Margin="0,10,0,20"/>

            <!-- Secci√≥n de Seguridad -->
            <Label Text="Seguridad"
                   FontSize="20"
                   FontAttributes="Bold"
                   TextColor="{StaticResource Primary}"
                   Margin="0,0,0,10"/>

            <Frame BackgroundColor="{AppThemeBinding Light={StaticResource BackgroundMediumLight}, Dark={StaticResource BackgroundMedium}}"
                   CornerRadius="10"
                   Padding="0"
                   Margin="0,0,0,20">
                <VerticalStackLayout Spacing="0">

                    <!-- Opci√≥n de Face ID/Touch ID -->
                    <Grid Padding="20,15"
                          BackgroundColor="{AppThemeBinding Light={StaticResource BackgroundMediumLight}, Dark={StaticResource BackgroundMedium}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <VerticalStackLayout Grid.Column="0" Spacing="2">
                            <Label Text="Face ID / Touch ID"
                                   TextColor="{AppThemeBinding Light={StaticResource TextPrimaryLight}, Dark={StaticResource TextPrimary}}"
                                   FontSize="16"/>
                            <Label x:Name="BiometricStatusLabel"
                                   Text="No configurado"
                                   TextColor="{AppThemeBinding Light={StaticResource TextSecondaryLight}, Dark={StaticResource TextSecondary}}"
                                   FontSize="12"/>
                        </VerticalStackLayout>

                        <Switch Grid.Column="1"
                                x:Name="BiometricSwitch"
                                OnColor="{StaticResource Primary}"
                                ThumbColor="White"
                                VerticalOptions="Center"
                                Toggled="OnBiometricToggled"/>
                    </Grid>

                    <BoxView HeightRequest="1" 
                             BackgroundColor="{AppThemeBinding Light={StaticResource BackgroundLightLight}, Dark={StaticResource BackgroundDark}}" 
                             Margin="20,0"/>

                    <!-- Cambiar contrase√±a -->
                    <Grid Padding="20,15"
                          BackgroundColor="{AppThemeBinding Light={StaticResource BackgroundMediumLight}, Dark={StaticResource BackgroundMedium}}">
                        <Grid.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnChangePasswordTapped"/>
                        </Grid.GestureRecognizers>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <Label Grid.Column="0"
                               Text="{extensions:Translate ChangePassword}"
                               TextColor="{AppThemeBinding Light={StaticResource TextPrimaryLight}, Dark={StaticResource TextPrimary}}"
                               FontSize="16"
                               VerticalOptions="Center"/>

                        <Label Grid.Column="1"
                               Text="‚Üí"
                               TextColor="{AppThemeBinding Light={StaticResource TextSecondaryLight}, Dark={StaticResource TextSecondary}}"
                               FontSize="20"
                               VerticalOptions="Center"/>
                    </Grid>
                </VerticalStackLayout>
            </Frame>

            <!-- Secci√≥n de Lectura -->
            <Label Text="{extensions:Translate Reading}"
                   FontSize="20"
                   FontAttributes="Bold"
                   TextColor="{StaticResource Primary}"
                   Margin="0,0,0,10"/>

            <Frame BackgroundColor="{AppThemeBinding Light={StaticResource BackgroundMediumLight}, Dark={StaticResource BackgroundMedium}}"
                   CornerRadius="10"
                   Padding="0"
                   Margin="0,0,0,20">
                <VerticalStackLayout Spacing="0">

                    <!-- Tama√±o de fuente -->
                    <Grid Padding="20,15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="50"/>
                        </Grid.ColumnDefinitions>

                        <Label Grid.Column="0"
                               Text="{extensions:Translate FontSize}"
                               TextColor="{AppThemeBinding Light={StaticResource TextPrimaryLight}, Dark={StaticResource TextPrimary}}"
                               FontSize="16"
                               VerticalOptions="Center"/>

                        <Slider Grid.Column="1"
                                x:Name="FontSizeSlider"
                                Minimum="12"
                                Maximum="24"
                                Value="16"
                                ThumbColor="{StaticResource Primary}"
                                MinimumTrackColor="{StaticResource Primary}"
                                MaximumTrackColor="{StaticResource TextMuted}"
                                ValueChanged="OnFontSizeChanged"/>

                        <Label Grid.Column="2"
                               x:Name="FontSizeLabel"
                               Text="16"
                               TextColor="{AppThemeBinding Light={StaticResource TextSecondaryLight}, Dark={StaticResource TextSecondary}}"
                               FontSize="16"
                               HorizontalTextAlignment="Center"
                               VerticalOptions="Center"/>
                    </Grid>

                    <BoxView HeightRequest="1" 
                             BackgroundColor="{AppThemeBinding Light={StaticResource BackgroundLightLight}, Dark={StaticResource BackgroundDark}}" 
                             Margin="20,0"/>

                    <!-- Modo de lectura nocturno -->
                    <Grid Padding="20,15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <Label Grid.Column="0"
                               Text="{extensions:Translate NightMode}"
                               TextColor="{AppThemeBinding Light={StaticResource TextPrimaryLight}, Dark={StaticResource TextPrimary}}"
                               FontSize="16"
                               VerticalOptions="Center"/>

                        <Switch Grid.Column="1"
                                x:Name="NightModeSwitch"
                                OnColor="{StaticResource Primary}"
                                ThumbColor="White"
                                VerticalOptions="Center"
                                Toggled="OnNightModeToggled"/>
                    </Grid>

                    <BoxView HeightRequest="1" 
                             BackgroundColor="{AppThemeBinding Light={StaticResource BackgroundLightLight}, Dark={StaticResource BackgroundDark}}" 
                             Margin="20,0"/>

                    <!-- Mantener pantalla encendida -->
                    <Grid Padding="20,15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <Label Grid.Column="0"
                               Text="{extensions:Translate KeepScreenOn}"
                               TextColor="{AppThemeBinding Light={StaticResource TextPrimaryLight}, Dark={StaticResource TextPrimary}}"
                               FontSize="16"
                               VerticalOptions="Center"/>

                        <Switch Grid.Column="1"
                                x:Name="KeepScreenOnSwitch"
                                OnColor="{StaticResource Primary}"
                                ThumbColor="White"
                                VerticalOptions="Center"
                                Toggled="OnKeepScreenOnToggled"/>
                    </Grid>
                </VerticalStackLayout>
            </Frame>

            <!-- Secci√≥n de Apariencia -->
            <Label Text="{extensions:Translate Appearance}"
                   FontSize="20"
                   FontAttributes="Bold"
                   TextColor="{StaticResource Primary}"
                   Margin="0,0,0,10"/>

            <Frame BackgroundColor="{AppThemeBinding Light={StaticResource BackgroundMediumLight}, Dark={StaticResource BackgroundMedium}}"
                   CornerRadius="10"
                   Padding="0"
                   Margin="0,0,0,20">
                <VerticalStackLayout Spacing="0">

                    <!-- Tema de la aplicaci√≥n -->
                    <Grid Padding="20,15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <VerticalStackLayout Grid.Column="0" Spacing="2">
                            <Label Text="{extensions:Translate AppTheme}"
                                   TextColor="{AppThemeBinding Light={StaticResource TextPrimaryLight}, Dark={StaticResource TextPrimary}}"
                                   FontSize="16"/>
                            <Label x:Name="ThemeStatusLabel"
                                   Text="{extensions:Translate System}"
                                   TextColor="{AppThemeBinding Light={StaticResource TextSecondaryLight}, Dark={StaticResource TextSecondary}}"
                                   FontSize="14"/>
                        </VerticalStackLayout>

                        <Picker Grid.Column="1"
                                x:Name="ThemePicker"
                                WidthRequest="120"
                                TextColor="{StaticResource Primary}"
                                SelectedIndexChanged="OnThemeChanged">
                            <Picker.Items>
                                <x:String>Sistema</x:String>
                                <x:String>Claro</x:String>
                                <x:String>Oscuro</x:String>
                            </Picker.Items>
                        </Picker>
                    </Grid>

                    <BoxView HeightRequest="1" 
                             BackgroundColor="{AppThemeBinding Light={StaticResource BackgroundLightLight}, Dark={StaticResource BackgroundDark}}" 
                             Margin="20,0"/>

                    <!-- Idioma -->
                    <Grid Padding="20,15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <VerticalStackLayout Grid.Column="0" Spacing="2">
                            <Label Text="{extensions:Translate Language}"
                                   TextColor="{AppThemeBinding Light={StaticResource TextPrimaryLight}, Dark={StaticResource TextPrimary}}"
                                   FontSize="16"/>
                            <Label x:Name="LanguageStatusLabel"
                                   Text="{extensions:Translate Spanish}"
                                   TextColor="{AppThemeBinding Light={StaticResource TextSecondaryLight}, Dark={StaticResource TextSecondary}}"
                                   FontSize="14"/>
                        </VerticalStackLayout>

                        <Picker Grid.Column="1"
                                x:Name="LanguagePicker"
                                WidthRequest="120"
                                TextColor="{StaticResource Primary}"
                                SelectedIndexChanged="OnLanguageChanged">
                            <Picker.Items>
                                <x:String>Espa√±ol</x:String>
                                <x:String>English</x:String>
                            </Picker.Items>
                        </Picker>
                    </Grid>
                </VerticalStackLayout>
            </Frame>
            
            <!-- Secci√≥n de Notificaciones -->
            <Label Text="{extensions:Translate Notifications}"
                   FontSize="20"
                   FontAttributes="Bold"
                   TextColor="{StaticResource Primary}"
                   Margin="0,0,0,10"/>

            <Frame BackgroundColor="{AppThemeBinding Light={StaticResource BackgroundMediumLight}, Dark={StaticResource BackgroundMedium}}"
                   CornerRadius="10"
                   Padding="0"
                   Margin="0,0,0,20">
                <VerticalStackLayout Spacing="0">

                    <!-- Notificaciones de actualizaciones -->
                    <Grid Padding="20,15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <VerticalStackLayout Grid.Column="0" Spacing="2">
                            <Label Text="{extensions:Translate NewChapters}"
                                   TextColor="{AppThemeBinding Light={StaticResource TextPrimaryLight}, Dark={StaticResource TextPrimary}}"
                                   FontSize="16"/>
                            <Label Text="{extensions:Translate NotifyNewChapters}"
                                   TextColor="{AppThemeBinding Light={StaticResource TextSecondaryLight}, Dark={StaticResource TextSecondary}}"
                                   FontSize="12"/>
                        </VerticalStackLayout>

                        <Switch Grid.Column="1"
                                x:Name="UpdateNotificationsSwitch"
                                OnColor="{StaticResource Primary}"
                                ThumbColor="White"
                                VerticalOptions="Center"
                                Toggled="OnUpdateNotificationsToggled"/>
                    </Grid>

                    <BoxView HeightRequest="1" 
                             BackgroundColor="{AppThemeBinding Light={StaticResource BackgroundLightLight}, Dark={StaticResource BackgroundDark}}" 
                             Margin="20,0"/>

                    <!-- Notificaciones de recomendaciones -->
                    <Grid Padding="20,15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <VerticalStackLayout Grid.Column="0" Spacing="2">
                            <Label Text="{extensions:Translate RecommendedNovels}"
                                   TextColor="{AppThemeBinding Light={StaticResource TextPrimaryLight}, Dark={StaticResource TextPrimary}}"
                                   FontSize="16"/>
                            <Label Text="Sugerencias basadas en tu lectura"
                                   TextColor="{AppThemeBinding Light={StaticResource TextSecondaryLight}, Dark={StaticResource TextSecondary}}"
                                   FontSize="12"/>
                        </VerticalStackLayout>

                        <Switch Grid.Column="1"
                                x:Name="RecommendationNotificationsSwitch"
                                OnColor="{StaticResource Primary}"
                                ThumbColor="White"
                                VerticalOptions="Center"
                                Toggled="OnRecommendationNotificationsToggled"/>
                    </Grid>
                </VerticalStackLayout>
            </Frame>

            <!-- Secci√≥n de Descargas -->
            <Label Text="{extensions:Translate Downloads}"
                   FontSize="20"
                   FontAttributes="Bold"
                   TextColor="{StaticResource Primary}"
                   Margin="0,0,0,10"/>

            <Frame BackgroundColor="{AppThemeBinding Light={StaticResource BackgroundMediumLight}, Dark={StaticResource BackgroundMedium}}"
                   CornerRadius="10"
                   Padding="0"
                   Margin="0,0,0,20">
                <VerticalStackLayout Spacing="0">

                    <!-- Solo WiFi -->
                    <Grid Padding="20,15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <VerticalStackLayout Grid.Column="0" Spacing="2">
                            <Label Text="{extensions:Translate WifiOnly}"
                                   TextColor="{AppThemeBinding Light={StaticResource TextPrimaryLight}, Dark={StaticResource TextPrimary}}"
                                   FontSize="16"/>
                            <Label Text="Descargar solo con conexi√≥n WiFi"
                                   TextColor="{AppThemeBinding Light={StaticResource TextSecondaryLight}, Dark={StaticResource TextSecondary}}"
                                   FontSize="12"/>
                        </VerticalStackLayout>

                        <Switch Grid.Column="1"
                                x:Name="WifiOnlySwitch"
                                OnColor="{StaticResource Primary}"
                                ThumbColor="White"
                                VerticalOptions="Center"
                                Toggled="OnWifiOnlyToggled"/>
                    </Grid>

                    <BoxView HeightRequest="1" 
                             BackgroundColor="{AppThemeBinding Light={StaticResource BackgroundLightLight}, Dark={StaticResource BackgroundDark}}" 
                             Margin="20,0"/>

                    <!-- L√≠mite de descargas -->
                    <Grid Padding="20,15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <VerticalStackLayout Grid.Column="0" Spacing="2">
                            <Label Text="{extensions:Translate ChapterLimit}"
                                   TextColor="{AppThemeBinding Light={StaticResource TextPrimaryLight}, Dark={StaticResource TextPrimary}}"
                                   FontSize="16"/>
                            <Label x:Name="DownloadLimitLabel"
                                   Text="{extensions:Translate MaxChaptersPerNovel}"
                                   TextColor="{AppThemeBinding Light={StaticResource TextSecondaryLight}, Dark={StaticResource TextSecondary}}"
                                   FontSize="12"/>
                        </VerticalStackLayout>

                        <Stepper Grid.Column="1"
                                 x:Name="DownloadLimitStepper"
                                 Minimum="5"
                                 Maximum="50"
                                 Value="10"
                                 Increment="5"
                                 ValueChanged="OnDownloadLimitChanged"/>
                    </Grid>

                    <BoxView HeightRequest="1" 
                             BackgroundColor="{AppThemeBinding Light={StaticResource BackgroundLightLight}, Dark={StaticResource BackgroundDark}}" 
                             Margin="20,0"/>

                    <!-- Limpiar cach√© -->
                    <Grid Padding="20,15">
                        <Grid.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnClearCacheTapped"/>
                        </Grid.GestureRecognizers>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <VerticalStackLayout Grid.Column="0" Spacing="2">
                            <Label Text="{extensions:Translate ClearCache}"
                                   TextColor="{AppThemeBinding Light={StaticResource TextPrimaryLight}, Dark={StaticResource TextPrimary}}"
                                   FontSize="16"/>
                            <Label x:Name="CacheSizeLabel"
                                   Text="0 MB"
                                   TextColor="{AppThemeBinding Light={StaticResource TextSecondaryLight}, Dark={StaticResource TextSecondary}}"
                                   FontSize="12"/>
                        </VerticalStackLayout>

                        <Label Grid.Column="1"
                               Text="üóëÔ∏è"
                               FontSize="20"
                               VerticalOptions="Center"/>
                    </Grid>
                </VerticalStackLayout>
            </Frame>

            <!-- Secci√≥n de Cuenta -->
            <Label Text="{extensions:Translate Account}"
                   FontSize="20"
                   FontAttributes="Bold"
                   TextColor="{StaticResource Primary}"
                   Margin="0,0,0,10"/>

            <Frame BackgroundColor="{AppThemeBinding Light={StaticResource BackgroundMediumLight}, Dark={StaticResource BackgroundMedium}}"
                   CornerRadius="10"
                   Padding="0"
                   Margin="0,0,0,20">
                <VerticalStackLayout Spacing="0">

                    <!-- Informaci√≥n de la cuenta -->
                    <Grid Padding="20,15">
                        <Grid.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnAccountInfoTapped"/>
                        </Grid.GestureRecognizers>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <VerticalStackLayout Grid.Column="0" Spacing="2">
                            <Label Text="{extensions:Translate AccountInfo}"
                                   TextColor="{AppThemeBinding Light={StaticResource TextPrimaryLight}, Dark={StaticResource TextPrimary}}"
                                   FontSize="16"/>
                            <Label x:Name="AccountEmailLabel"
                                   Text="usuario@email.com"
                                   TextColor="{AppThemeBinding Light={StaticResource TextSecondaryLight}, Dark={StaticResource TextSecondary}}"
                                   FontSize="12"/>
                        </VerticalStackLayout>

                        <Label Grid.Column="1"
                               Text="‚Üí"
                               TextColor="{AppThemeBinding Light={StaticResource TextSecondaryLight}, Dark={StaticResource TextSecondary}}"
                               FontSize="20"
                               VerticalOptions="Center"/>
                    </Grid>

                    <BoxView HeightRequest="1" 
                             BackgroundColor="{AppThemeBinding Light={StaticResource BackgroundLightLight}, Dark={StaticResource BackgroundDark}}" 
                             Margin="20,0"/>

                    <!-- Cerrar sesi√≥n -->
                    <Grid Padding="20,15">
                        <Grid.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnLogoutTapped"/>
                        </Grid.GestureRecognizers>

                        <Label Text="{extensions:Translate Logout}"
                               TextColor="{StaticResource Error}"
                               FontSize="16"
                               HorizontalOptions="Center"
                               VerticalOptions="Center"/>
                    </Grid>
                </VerticalStackLayout>
            </Frame>

            <!-- Versi√≥n de la app -->
            <Label x:Name="VersionLabel"
                   Text="NovelBook v1.0.0"
                   TextColor="{StaticResource TextMuted}"
                   FontSize="12"
                   HorizontalOptions="Center"
                   Margin="0,20,0,40"/>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>