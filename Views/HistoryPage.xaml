<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="NovelBook.Views.HistoryPage"
             Title="Historial"
             BackgroundColor="{StaticResource BackgroundDark}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header con estadÃ­sticas -->
        <Frame Grid.Row="0"
               BackgroundColor="{StaticResource BackgroundMedium}"
               CornerRadius="0"
               Padding="20"
               Margin="0,0,0,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- CapÃ­tulos leÃ­dos -->
                <VerticalStackLayout Grid.Column="0" HorizontalOptions="Center">
                    <Label x:Name="ChaptersReadLabel"
                           Text="0"
                           FontSize="24"
                           FontAttributes="Bold"
                           TextColor="{StaticResource Primary}"
                           HorizontalTextAlignment="Center"/>
                    <Label Text="CapÃ­tulos"
                           FontSize="12"
                           TextColor="{StaticResource TextSecondary}"
                           HorizontalTextAlignment="Center"/>
                </VerticalStackLayout>

                <!-- Tiempo de lectura -->
                <VerticalStackLayout Grid.Column="1" HorizontalOptions="Center">
                    <Label x:Name="TotalTimeLabel"
                           Text="0h"
                           FontSize="24"
                           FontAttributes="Bold"
                           TextColor="{StaticResource Primary}"
                           HorizontalTextAlignment="Center"/>
                    <Label Text="Tiempo total"
                           FontSize="12"
                           TextColor="{StaticResource TextSecondary}"
                           HorizontalTextAlignment="Center"/>
                </VerticalStackLayout>

                <!-- Racha actual -->
                <VerticalStackLayout Grid.Column="2" HorizontalOptions="Center">
                    <Label x:Name="StreakLabel"
                           Text="0"
                           FontSize="24"
                           FontAttributes="Bold"
                           TextColor="{StaticResource Primary}"
                           HorizontalTextAlignment="Center"/>
                    <Label Text="DÃ­as seguidos"
                           FontSize="12"
                           TextColor="{StaticResource TextSecondary}"
                           HorizontalTextAlignment="Center"/>
                </VerticalStackLayout>
            </Grid>
        </Frame>

        <!-- Filtros y opciones -->
        <Grid Grid.Row="1" Padding="10,0" ColumnSpacing="10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Filtro de vista -->
            <Picker x:Name="ViewPicker"
                    Grid.Column="0"
                    BackgroundColor="{StaticResource BackgroundMedium}"
                    TextColor="{StaticResource TextPrimary}"
                    SelectedIndexChanged="OnViewPickerChanged">
                <Picker.Items>
                    <x:String>ðŸ“… Historial completo</x:String>
                    <x:String>ðŸ“š Por novela</x:String>
                    <x:String>ðŸ“† Hoy</x:String>
                    <x:String>ðŸ“… Esta semana</x:String>
                    <x:String>ðŸ“… Este mes</x:String>
                </Picker.Items>
            </Picker>

            <!-- BotÃ³n de limpiar -->
            <Button Grid.Column="1"
                    x:Name="ClearButton"
                    Text="ðŸ—‘ï¸"
                    BackgroundColor="{StaticResource BackgroundMedium}"
                    TextColor="{StaticResource TextSecondary}"
                    WidthRequest="50"
                    HeightRequest="40"
                    CornerRadius="20"
                    Clicked="OnClearHistoryClicked"/>
        </Grid>

        <!-- Lista de historial -->
        <ScrollView Grid.Row="2" Padding="10">
            <StackLayout x:Name="HistoryContainer" Spacing="10">
                <!-- Los elementos se agregarÃ¡n dinÃ¡micamente aquÃ­ -->

                <!-- Mensaje cuando no hay historial -->
                <Label x:Name="NoHistoryLabel"
                       Text="AÃºn no has leÃ­do ningÃºn capÃ­tulo"
                       TextColor="{StaticResource TextSecondary}"
                       HorizontalOptions="Center"
                       VerticalOptions="CenterAndExpand"
                       FontSize="16"
                       IsVisible="False"/>

                <!-- Indicador de carga -->
                <ActivityIndicator x:Name="LoadingIndicator"
                                   IsRunning="False"
                                   IsVisible="False"
                                   Color="{StaticResource Primary}"
                                   HorizontalOptions="Center"
                                   VerticalOptions="CenterAndExpand"/>
            </StackLayout>
        </ScrollView>
    </Grid>
</ContentPage>